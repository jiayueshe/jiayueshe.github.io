<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="é€Ÿåº¦ä¸æ¿€æƒ…ä¹‹ Vite åˆä½“éªŒï¼ˆæœ€ä½³å…¥é—¨ï¼‰, IT å­¦ä¹  èµ„æºç«™ C# CAD .net core EF Javascript Flutter TypeScript æ•°æ®ç»“æ„ ç®—æ³• ç½‘ç»œ æµ‹è¯• äº§å“">
    <meta name="description" content="IT å­¦ä¹  èµ„æºç«™ C# CAD .net core EF Javascript Flutter TypeScript æ•°æ®ç»“æ„ ç®—æ³• ç½‘ç»œ æµ‹è¯• äº§å“">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>é€Ÿåº¦ä¸æ¿€æƒ…ä¹‹ Vite åˆä½“éªŒï¼ˆæœ€ä½³å…¥é—¨ï¼‰ | IT å­¦ä¹  èµ„æº</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="IT å­¦ä¹  èµ„æº" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">IT å­¦ä¹  èµ„æº</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">IT å­¦ä¹  èµ„æº</div>
        <div class="logo-desc">
            
            IT å­¦ä¹  èµ„æºç«™ C# CAD .net core EF Javascript Flutter TypeScript æ•°æ®ç»“æ„ ç®—æ³• ç½‘ç»œ æµ‹è¯• äº§å“
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/jiayueshe/jiayueshe.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/jiayueshe/jiayueshe.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/22.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">é€Ÿåº¦ä¸æ¿€æƒ…ä¹‹ Vite åˆä½“éªŒï¼ˆæœ€ä½³å…¥é—¨ï¼‰</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="container content">

    
    <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/vite/">
                                <span class="chip bg-color">vite</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%A1%86%E6%9E%B6/" class="post-category">
                                æ¡†æ¶
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2021-03-03
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2021-03-10
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    4.2k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    18 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>å¤§å®¶æœ€è¿‘å­¦ä¹  Vue3 å­¦åºŸäº†å—ï¼Ÿå°¤é›¨æºªå°¤å¤§å¤§é©¬ä¸åœè¹„åœ°åˆç»™å¤§å®¶é€æ¥äº†ä¸“é—¨ä¸º Vue3 æ‰“é€ çš„å¼€å‘åˆ©å™¨ â€” Viteã€‚ä½ æ˜¯å¦åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ Webpack è§‰å¾—ä¸é‚£ä¹ˆä¸æ»‘ï¼Œæ˜¯å¦ç­‰å¾…å¯åŠ¨ç¼–è¯‘å¯ä»¥å–å¥½å‡ å£çƒ­æ°´ï¼Ÿæœ¬æ–‡å°†å¸¦é¢†å¤§å®¶ç®€å•äº†è§£ Vite çš„åŸºæœ¬çŸ¥è¯†å’Œä½œç”¨ï¼Œè®©æˆ‘ä»¬æ›´å¥½çš„å¼€å¯ Vue3 å¼€å‘ä¹‹æ—…~ é¦–å…ˆï¼Œå­¦ä¹  Vite ä¹‹å‰å¾—è‡³å°‘æœ‰ 2 éƒ¨åˆ†çš„çŸ¥è¯†å‚¨å¤‡ï¼š1ï¼‰æŒæ¡ ES Modules ç‰¹æ€§ 2ï¼‰äº†è§£ Http2 æ ‡å‡†ï¼Œé™äºç¯‡å¹…ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°å•¦~</p>
<h2 id="ä¸€ã€é—®é¢˜æ¥æº"><a href="#ä¸€ã€é—®é¢˜æ¥æº" class="headerlink" title="ä¸€ã€é—®é¢˜æ¥æº"></a>ä¸€ã€é—®é¢˜æ¥æº</h2><h3 id="1-1-Webpack-æ§½ç‚¹"><a href="#1-1-Webpack-æ§½ç‚¹" class="headerlink" title="1.1 Webpack æ§½ç‚¹"></a>1.1 Webpack æ§½ç‚¹</h3><p>å¦‚æœåº”ç”¨æ¯”è¾ƒå¤æ‚ï¼Œé‚£ä¹ˆä½¿ç”¨ Webpack çš„å¼€å‘è¿‡ç¨‹å°±ç›¸å¯¹æ²¡æœ‰é‚£ä¹ˆèˆ’é€‚ã€‚</p>
<pre><code>  - Webpack Dev Server å†·å¯åŠ¨æ—¶é—´ä¼šæ¯”è¾ƒé•¿
  - Webpack HMR çƒ­æ›´æ–°çš„ååº”é€Ÿåº¦æ¯”è¾ƒæ…¢
</code></pre>
<p><strong><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxO68MtsrFIplBh3GtpG8Vk9iczYsN4iaJbNZdamHXibF1rUFdqvj6U1b9w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></strong></p>
<h3 id="1-2-å›é¡¾-Webpack-åˆè¡·"><a href="#1-2-å›é¡¾-Webpack-åˆè¡·" class="headerlink" title="1.2 å›é¡¾ Webpack åˆè¡·"></a>1.2 å›é¡¾ Webpack åˆè¡·</h3><p>ã€ä¹‹å‰æŠ€æœ¯ç¯å¢ƒã€‘æˆ‘ä»¬ä½¿ç”¨ Webpack æ‰“åŒ…åº”ç”¨ä»£ç ï¼Œæœ€åç”Ÿæˆä¸€ä¸ª bundle.jsï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š</p>
<pre><code>  - æµè§ˆå™¨ç¯å¢ƒå¹¶ä¸å¾ˆå¥½çš„æ¥æ”¯æŒæ¨¡å—åŒ–
  - é›¶æ•£çš„æ¨¡å—æ–‡ä»¶ä¼šäº§ç”Ÿå¤§é‡çš„ HTTP è¯·æ±‚
</code></pre>
<h3 id="1-3-æ€è€ƒç°åœ¨"><a href="#1-3-æ€è€ƒç°åœ¨" class="headerlink" title="1.3 æ€è€ƒç°åœ¨"></a>1.3 æ€è€ƒç°åœ¨</h3><p>bundle å¤ªå¤§ï¼Œè¦é‡‡ç”¨å„ç§ Code Splittingï¼Œå‹ç¼©ä»£ç ï¼Œå»é™¤çš„æ’ä»¶ï¼Œæå–çš„ç¬¬ä¸‰æ–¹åº“ï¼Œso tired~ ã€å½“å‰æŠ€æœ¯ç¯å¢ƒã€‘æ˜¯å¦èƒ½è§£å†³ Webpack å½“æ—¶çš„éš¾ç‚¹ï¼Ÿthinking~~</p>
<h2 id="äºŒã€è§£å†³æ€è·¯"><a href="#äºŒã€è§£å†³æ€è·¯" class="headerlink" title="äºŒã€è§£å†³æ€è·¯"></a>äºŒã€è§£å†³æ€è·¯</h2><h3 id="2-1-ES-Module"><a href="#2-1-ES-Module" class="headerlink" title="2.1 ES Module"></a>2.1 ES Module</h3><ul>
<li>éšç€æµè§ˆå™¨çš„å¯¹ ES æ ‡å‡†æ”¯æŒçš„é€æ¸å®Œå–„ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜å·²ç»æ…¢æ…¢ä¸å­˜åœ¨äº†ã€‚ç°é˜¶æ®µç»å¤§å¤šæ•°æµè§ˆå™¨éƒ½æ˜¯æ”¯æŒ ES Modules çš„ã€‚</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxiaQ2jdztBW5sh45tU9wAJsAkNA15Zk8ia3eAXA46qFRFOqNFWspgSjIg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p>å…¶æœ€å¤§çš„ç‰¹ç‚¹æ˜¯åœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨ export import çš„æ–¹å¼å¯¼å…¥å’Œå¯¼å‡ºæ¨¡å—ï¼Œåœ¨ script æ ‡ç­¾é‡Œå†™ <code>type=&quot;module&quot;</code> ï¼Œç„¶åä½¿ç”¨ ES Moduleã€‚</p>
<pre><code>// å½“ html é‡ŒåµŒå…¥ ES module çš„ script æ ‡ç­¾æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå‘èµ· http è¯·æ±‚ï¼Œè¯·æ±‚ http server æ‰˜ç®¡çš„ main.js ;
// index.html
&lt;script type=&quot;module&quot; src=&quot;/src/main.js&quot;&gt;&lt;/script&gt;


// ä½¿ç”¨ export å¯¼å‡ºæ¨¡å—, import å¯¼å…¥æ¨¡å—ï¼š
// main.js 
import &#123; createApp &#125; from &#39;vue&#39;
import App from &#39;./App.vue&#39;
import &#39;./index.css&#39;

createApp(App).mount(&#39;#app&#39;)
</code></pre>
<p>ç›´æ¥è®¿é—® index.htmlï¼ŒæŠ¥é”™ï¼š<img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxXRe2963J6wwH63xgPEZ1EsokmSiaGBDLR754C6ySFjCPupxJJvnogqQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">åœ¨æµè§ˆå™¨é‡Œä½¿ç”¨ ES module æ˜¯ä½¿ç”¨ http è¯·æ±‚æ‹¿åˆ°æ¨¡å—çš„ï¼Œæ‰€ä»¥ file åè®®çš„è¯·æ±‚ä¸å…è®¸ã€‚</p>
<h3 id="2-2-æ¨¡å—è§£æ"><a href="#2-2-æ¨¡å—è§£æ" class="headerlink" title="2.2 æ¨¡å—è§£æ"></a>2.2 æ¨¡å—è§£æ</h3><p>é‚£æˆ‘ä»¬å°±åœ¨æœ¬åœ°èµ·ä¸€ä¸ªé™æ€æœåŠ¡ï¼Œå†æ¥æ‰“å¼€ä¸€ä¸‹ index.html æ¥çœ‹ä¸‹<img src="/jiayueshe/jiayueshe.github/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"><img src="/jiayueshe/jiayueshe.github/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡">æŠ¥é”™ï¼šæ‰¾ä¸åˆ°æ¨¡å— vueï¼›åŸå› ï¼šâ€/â€œ, â€œ./â€œ, or â€œ../â€œå¼€å¤´çš„ import ç›¸å¯¹/ç»å¯¹è·¯å¾„ï¼Œæ‰æ˜¯åˆæ³•çš„ã€‚</p>
<pre><code>import vue from &#39;vue&#39;
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´æµè§ˆå™¨ä¸­çš„ ESM æ˜¯è·å–ä¸åˆ°å¯¼å…¥çš„æ¨¡å—å†…å®¹çš„ã€‚å¹³æ—¶æˆ‘ä»¬å†™ä»£ç ï¼Œå¦‚æœä¸æ˜¯å¼•ç”¨ç›¸å¯¹è·¯å¾„çš„æ¨¡å—ï¼Œè€Œæ˜¯å¼•ç”¨ <code>node_modules</code> çš„æ¨¡å—ï¼Œéƒ½æ˜¯ç›´æ¥ <code>import xxx from &#39;xxx&#39;</code>ï¼Œç”± <code>Webpack</code> ç­‰å·¥å…·æ¥å¸®æˆ‘ä»¬å¤„ç† js é—´çš„ç›¸äº’ä¾èµ–å…³ç³»ï¼Œæ‰¾è¿™ä¸ªæ¨¡å—çš„å…·ä½“è·¯å¾„è¿›è¡Œæ‰“åŒ…ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸çŸ¥é“ä½ é¡¹ç›®é‡Œæœ‰ <code>node_modules</code>ï¼Œå®ƒåªèƒ½é€šè¿‡ç›¸å¯¹è·¯å¾„æˆ–è€…ç»å¯¹è·¯å¾„å»å¯»æ‰¾æ¨¡å—ã€‚</p>
<p>é‚£å’‹åŠï¼Ÿï¼Ÿï¼Ÿæ‰€ä»¥ <strong>Vite çš„ä¸€ä¸ªä»»åŠ¡å°±æ˜¯å¯åŠ¨ä¸€ä¸ª web server å»ä»£ç†è¿™äº›æ¨¡å—ï¼ŒVite è¿™é‡Œæ˜¯å€Ÿç”¨äº† koa æ¥å¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡</strong></p>
<pre><code>export function createServer(config: ServerConfig): Server &#123;
  // ...
  const app = new Koa&lt;State, Context&gt;()
  const server = resolveServer(config, app.callback())
  
  // ...
  const listen = server.listen.bind(server)
  server.listen = (async (port: number, ...args: any[]) =&gt; &#123;
    if (optimizeDeps.auto !== false) &#123;
      await require(&#39;../optimizer&#39;).optimizeDeps(config)
    &#125;
    return listen(port, ...args)
  &#125;) as any
  
  server.once(&#39;listening&#39;, () =&gt; &#123;
    context.port = (server.address() as AddressInfo).port
  &#125;)
  
  return server
&#125;
</code></pre>
<p>é‚£è¿™å°±å¼•å‡ºäº† <strong>Vite çš„ä¸€ä¸ªå®ç°æ ¸å¿ƒ - æ‹¦æˆªæµè§ˆå™¨å¯¹æ¨¡å—çš„è¯·æ±‚å¹¶è¿”å›å¤„ç†åçš„ç»“æœ</strong>æˆ‘ä»¬æ¥çœ‹ä¸‹ Vite æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿ</p>
<h3 id="2-3-module-å‰ç¼€"><a href="#2-3-module-å‰ç¼€" class="headerlink" title="2.3 /@module/å‰ç¼€"></a>2.3 <code>/@module/</code>å‰ç¼€</h3><p>é€šè¿‡å·¥ç¨‹ä¸‹çš„ main.js å’Œå¼€å‘ç¯å¢ƒä¸‹çš„å®é™…åŠ è½½çš„ main.js å¯¹æ¯”ï¼Œå‘ç° main.js å†…å®¹å‘ç”Ÿäº†æ”¹å˜ï¼Œç”±</p>
<pre><code>import &#123; createApp &#125; from &#39;vue&#39;
import App from &#39;./App.vue&#39;
import &#39;./index.css&#39;

createApp(App).mount(&#39;#app&#39;)
</code></pre>
<p>å˜æˆäº†</p>
<pre><code>import &#123; createApp &#125; from &#39;/@modules/vue.js&#39;
import App from &#39;/src/App.vue&#39;
import &#39;/src/index.css?import&#39;

createApp(App).mount(&#39;#app&#39;)
</code></pre>
<p>ä¸ºäº†è§£å†³ <code>import xxx from &#39;xxx&#39;</code> æŠ¥é”™çš„é—®é¢˜ï¼ŒVite å¯¹è¿™ç§èµ„æºè·¯å¾„åšäº†ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†ï¼ŒåŠ ä¸€ä¸ª<code>/@module/</code>å‰ç¼€ã€‚æˆ‘ä»¬åœ¨ <code>src/node/server/serverPluginModuleRewrite.ts</code> æºç è¿™ä¸ª koa ä¸­é—´ä»¶é‡Œå¯ä»¥çœ‹åˆ° Vite å¯¹ import éƒ½åšäº†ä¸€å±‚å¤„ç†ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åœ¨ koa ä¸­é—´ä»¶é‡Œè·å–è¯·æ±‚ ctx.body</li>
<li>é€šè¿‡ <strong>es-module-lexer</strong> è§£æèµ„æº ast æ‹¿åˆ° import çš„å†…å®¹</li>
<li>åˆ¤æ–­ import çš„èµ„æºæ˜¯å¦æ˜¯ç»å¯¹è·¯å¾„ï¼Œç»å¯¹è§†ä¸º npm æ¨¡å—</li>
<li><strong>rewriteImports</strong> è¿”å›å¤„ç†åçš„èµ„æºè·¯å¾„ï¼šâ€vueâ€ =&gt; â€œ/@modules/vueâ€</li>
</ul>
<p>**å¦‚ä½•æ”¯æŒ <code>/@module/ï¼Ÿ</code>**åœ¨ <code>/src/node/server/serverPluginModuleResolve.ts</code> é‡Œå¯ä»¥çœ‹åˆ°å¤§æ¦‚çš„å¤„ç†é€»è¾‘æ˜¯</p>
<ul>
<li>åœ¨ koa ä¸­é—´ä»¶é‡Œè·å–è¯·æ±‚ ctx.body</li>
<li>åˆ¤æ–­è·¯å¾„æ˜¯å¦ä»¥ /@module/ å¼€å¤´ï¼Œå¦‚æœæ˜¯å–å‡ºåŒ…å</li>
<li>å» node_module é‡Œæ‰¾åˆ°è¿™ä¸ªåº“ï¼ŒåŸºäº package.json è¿”å›å¯¹åº”çš„å†…å®¹</li>
</ul>
<h3 id="2-4-æ–‡ä»¶ç¼–è¯‘"><a href="#2-4-æ–‡ä»¶ç¼–è¯‘" class="headerlink" title="2.4 æ–‡ä»¶ç¼–è¯‘"></a>2.4 æ–‡ä»¶ç¼–è¯‘</h3><p>ä¸Šé¢æˆ‘ä»¬æåˆ°çš„æ˜¯å¯¹æ™®é€š js module çš„å¤„ç†ï¼Œé‚£å¯¹äºå…¶ä»–æ–‡ä»¶ï¼Œæ¯”å¦‚ <code>vue</code>ã€<code>css</code>ã€<code>ts</code>ç­‰æ˜¯å¦‚ä½•å¤„ç†çš„å‘¢ï¼Ÿæˆ‘ä»¬ä»¥ vue æ–‡ä»¶ä¸ºä¾‹æ¥çœ‹ä¸€ä¸‹ï¼Œåœ¨ Webpack é‡Œæˆ‘ä»¬æ˜¯ä½¿ç”¨çš„ vue-loader å¯¹å•æ–‡ä»¶ç»„ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå®é™…ä¸Š Vite åŒæ ·çš„æ˜¯<strong>æ‹¦æˆªäº†å¯¹æ¨¡å—çš„è¯·æ±‚å¹¶æ‰§è¡Œäº†ä¸€ä¸ªå®æ—¶ç¼–è¯‘</strong>ã€‚é€šè¿‡å·¥ç¨‹ä¸‹çš„ App.vue å’Œå¼€å‘ç¯å¢ƒä¸‹çš„å®é™…åŠ è½½çš„ App.vue å¯¹æ¯”ï¼Œå‘ç°å†…å®¹å‘ç”Ÿäº†æ”¹å˜ åŸæœ¬çš„ App.vue</p>
<pre><code>&lt;template&gt;
  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;
  &lt;HelloWorld msg=&quot;Hello Vue 3.0 + Vite&quot; /&gt;
&lt;/template&gt;

&lt;script&gt;
import HelloWorld from &#39;./components/HelloWorld.vue&#39;

export default &#123;
  name: &#39;App&#39;,
  components: &#123;
    HelloWorld
  &#125;
&#125;
&lt;/script&gt;
&lt;style&gt;
  body &#123;
    background: #fff;
  &#125;
&lt;/style&gt;
</code></pre>
<p>å˜æˆäº†</p>
<pre><code>import HelloWorld from &#39;/src/components/HelloWorld.vue&#39;

const __script = &#123;
    name: &#39;App&#39;,
    components: &#123;
        HelloWorld
    &#125;
&#125;

import &quot;/src/App.vue?type=style&amp;index=0&quot;
import &#123;render as __render&#125; from &quot;/src/App.vue?type=template&quot;
__script.render = __render
__script.__hmrId = &quot;/src/App.vue&quot;
typeof __VUE_HMR_RUNTIME__ !== &#39;undefined&#39; &amp;&amp; __VUE_HMR_RUNTIME__.createRecord(__script.__hmrId, __script)
__script.__file = &quot;/Users/liangxiaoying/myfile/wy-project/vite-demo/src/App.vue&quot;
export default __script
</code></pre>
<p>è¿™æ ·å°±æŠŠåŸæœ¬ä¸€ä¸ª <code>.vue</code> çš„æ–‡ä»¶æ‹†æˆäº†ä¸‰ä¸ªè¯·æ±‚ï¼ˆåˆ†åˆ«å¯¹åº” scriptã€style å’Œ templateï¼‰ ï¼Œæµè§ˆå™¨ä¼šå…ˆæ”¶åˆ°åŒ…å« script é€»è¾‘çš„ App.vue çš„å“åº”ï¼Œç„¶åè§£æåˆ° template å’Œ style çš„è·¯å¾„åï¼Œä¼šå†æ¬¡å‘èµ· HTTP è¯·æ±‚æ¥è¯·æ±‚å¯¹åº”çš„èµ„æºï¼Œæ­¤æ—¶ Vite å¯¹å…¶æ‹¦æˆªå¹¶å†æ¬¡å¤„ç†åè¿”å›ç›¸åº”çš„å†…å®¹ã€‚</p>
<p>å®é™…ä¸Šåœ¨çœ‹åˆ°è¿™ä¸ªæ€è·¯ä¹‹åï¼Œå¯¹äºå…¶ä»–çš„ç±»å‹æ–‡ä»¶çš„å¤„ç†å‡ ä¹éƒ½æ˜¯ç±»ä¼¼çš„é€»è¾‘ï¼Œæ ¹æ®è¯·æ±‚çš„ä¸åŒæ–‡ä»¶ç±»å‹ï¼Œåšå‡ºä¸åŒçš„ç¼–è¯‘å¤„ç†ã€‚<strong>å®é™…ä¸Š Vite å°±æ˜¯åœ¨æŒ‰éœ€åŠ è½½çš„åŸºç¡€ä¸Šé€šè¿‡æ‹¦æˆªè¯·æ±‚å®ç°äº†å®æ—¶æŒ‰éœ€ç¼–è¯‘</strong></p>
<h3 id="2-5-HTTP-2"><a href="#2-5-HTTP-2" class="headerlink" title="2.5 HTTP 2"></a>2.5 HTTP 2</h3><ul>
<li>é›¶æ•£æ¨¡å—æ–‡ä»¶åœ¨<strong>HTTP 1.x \</strong>ç¡®å®ä¼šäº§ç”Ÿå¤§é‡çš„ HTTP è¯·æ±‚ï¼Œè€Œå¤§é‡çš„ HTTP è¯·æ±‚åœ¨æµè§ˆå™¨ç«¯å°±ä¼šå¹¶å‘è¯·æ±‚èµ„æºçš„é—®é¢˜ï¼›ä½†æ˜¯è¿™äº›é—®é¢˜éšç€**HTTP 2**çš„å‡ºç°ï¼Œä¹Ÿå°±ä¸å¤å­˜åœ¨äº†ã€‚</li>
<li>why?</li>
</ul>
<p>HTTP 1.x ä¸­ï¼Œå¦‚æœæƒ³å¹¶å‘å¤šä¸ªè¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨å¤šä¸ª TCP é“¾æ¥ï¼Œä¸”æµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºï¼Œè¿˜ä¼šå¯¹å•ä¸ªåŸŸåæœ‰ 6-8 ä¸ªçš„ TCP é“¾æ¥è¯·æ±‚é™åˆ¶ï¼›HTTP 2 åˆ™å¯ä»¥ä½¿ç”¨<strong>å¤šè·¯å¤ç”¨</strong>ï¼Œä»£æ›¿åŸæ¥çš„åºåˆ—å’Œé˜»å¡æœºåˆ¶ã€‚æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯é€šè¿‡ä¸€ä¸ª TCP è¿æ¥å¹¶å‘å®Œæˆã€‚<img src="/jiayueshe/jiayueshe.github/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<h2 id="ä¸‰ã€ä¸‰å¤§ä½œç”¨"><a href="#ä¸‰ã€ä¸‰å¤§ä½œç”¨" class="headerlink" title="ä¸‰ã€ä¸‰å¤§ä½œç”¨"></a>ä¸‰ã€ä¸‰å¤§ä½œç”¨</h2><p>å³ Vite çš„ 3 å¤§æ ¸å¿ƒåŠŸèƒ½ï¼šStatic Server  + HMR + Compile</p>
<h3 id="3-1-å¿«é€Ÿçš„å†·å¯åŠ¨"><a href="#3-1-å¿«é€Ÿçš„å†·å¯åŠ¨" class="headerlink" title="3.1 å¿«é€Ÿçš„å†·å¯åŠ¨"></a>3.1 å¿«é€Ÿçš„å†·å¯åŠ¨</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxU87KR9JVnFl9g26xmuroHsCsZUrECBLDgrhPMWZYusw1mSqjcArlEA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">ç¤¾åŒºï¼šæ¯”å¦‚å¯ä»¥å€ŸåŠ©å„ç§ cli ï¼švue-cliã€create-react-app ç­‰ç­‰</p>
<p>å½“æˆ‘ä»¬å¯¹æ¯”ä½¿ç”¨ vue-cli-service serve çš„æ—¶å€™ï¼Œä¼šæœ‰æ˜æ˜¾æ„Ÿè§‰ã€‚<strong>å› ä¸º Webpack Dev Server åœ¨å¯åŠ¨æ—¶ï¼Œéœ€è¦å…ˆ buildâ€”éï¼Œè€Œ build çš„è¿‡ç¨‹æ˜¯éœ€è¦è€—è´¹å¾ˆå¤šæ—¶é—´çš„ã€‚**</strong><img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjx491micWSphF36pgeicUo6WUXpiaiajpYLia2dicibRxqdfqalWTaIZxnJF1GQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"><strong>**è€Œ Vite åˆ™å®Œå…¨ä¸åŒï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ Vite serve æ—¶ï¼ˆ\</strong>npm run dev**ï¼‰ï¼Œå†…éƒ¨ç›´æ¥å¯åŠ¨äº† Web Serverï¼Œå¹¶ä¸ä¼šå…ˆç¼–è¯‘æ‰€æœ‰çš„ä»£ç æ–‡ä»¶ã€‚<strong>é‚£ä»…ä»…æ˜¯å¯åŠ¨ Web Serverï¼Œé€Ÿåº¦ä¸Šè‡ªç„¶å°±è¹­è¹­è¹­çš„ upâ†‘ã€‚é‚£ä¹ˆåŠæ—¶è¯·æ±‚çš„ç¼–è¯‘å‘¢ï¼Ÿå…³äºæ”¯æŒ JSXï¼Œ TSXï¼ŒTypescript ç¼–è¯‘åˆ°åŸç”Ÿ JS â€”â€” Vite å¼•å…¥äº†</strong>EsBuild**ï¼Œæ˜¯ä½¿ç”¨ Go å†™çš„ï¼Œç›´æ¥ç¼–è¯‘ä¸º Native ä»£ç ï¼Œæ€§èƒ½è¦æ¯” TSC å¥½äºŒä¸‰åå€,æ‰€ä»¥å°±ä¸ç”¨æ‹…å¿ƒå•¦~ å½“ç„¶ä¹Ÿä¼šç”¨ä¸Šç¼“å­˜ï¼Œå…·ä½“è¿™é‡Œæš‚æ—¶ä¸æ‰©å±•ã€‚<img src="/jiayueshe/jiayueshe.github/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<h3 id="3-2-å³æ—¶çš„çƒ­æ¨¡å—æ›´æ–°"><a href="#3-2-å³æ—¶çš„çƒ­æ¨¡å—æ›´æ–°" class="headerlink" title="3.2 å³æ—¶çš„çƒ­æ¨¡å—æ›´æ–°"></a>3.2 å³æ—¶çš„çƒ­æ¨¡å—æ›´æ–°</h3><p>ç¤¾åŒºï¼šWebpack HMR ç­‰</p>
<p>çƒ­æ›´æ–°çš„æ—¶å€™ï¼ŒVite åªéœ€è¦ç«‹å³ç¼–è¯‘å½“å‰æ‰€ä¿®æ”¹çš„æ–‡ä»¶å³å¯ï¼Œæ‰€ä»¥ å“åº”é€Ÿåº¦éå¸¸å¿«ã€‚<img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxQYDdeabfibbYbvMv9ofluF3UFfbdvSw7ccLtNHuh98yEict844tlohWQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">è€Œ Webpack ä¿®æ”¹æŸä¸ªæ–‡ä»¶è¿‡åï¼Œä¼šè‡ªåŠ¨ä»¥è¿™ä¸ªæ–‡ä»¶ä¸ºå…¥å£é‡å†™ buildâ€”æ¬¡ï¼Œæ‰€æœ‰çš„æ¶‰åŠåˆ°çš„ä¾èµ–ä¹Ÿéƒ½ä¼šè¢«åŠ è½½ä¸€éï¼Œæ‰€ä»¥ååº”é€Ÿåº¦ä¼šæ…¢å¾ˆå¤šã€‚</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxt1hEjAceHTNSF6nYUBT3pwCnSEhyZjuhIr6VaLuzmL7XZ1A4z1gM0A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"><img src="https://mmbiz.qpic.cn/mmbiz_png/Tmczbd3NL02sfWXFEw0doMUvwAAPBVjxwc7elX8zqScUZKyICSdgJyOAEv6OFkj8jEeCvK79nrcz11m7nvuIfw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<h3 id="3-3-çœŸæ­£çš„æŒ‰éœ€ç¼–è¯‘"><a href="#3-3-çœŸæ­£çš„æŒ‰éœ€ç¼–è¯‘" class="headerlink" title="3.3 çœŸæ­£çš„æŒ‰éœ€ç¼–è¯‘"></a>3.3 çœŸæ­£çš„æŒ‰éœ€ç¼–è¯‘</h3><p>ç¤¾åŒºï¼šéœ€è¦å¼€å‘è€…è‡ªè¡Œåœ¨ä»£ç ä¸­å¼•å…¥å…¶ä»–æ’ä»¶ <code>impor(&#39;xx.js&#39;)</code> å®ç° dynamic-importï¼›å¦‚@babel/plugin-syntax-dynamic-import</p>
<p>ä½†æ˜¯åƒ Webpack è¿™ç±»å·¥å…·çš„åšæ³•æ˜¯å°†æ‰€æœ‰æ¨¡å—æå‰ç¼–è¯‘ã€æ‰“åŒ…è¿› bundle é‡Œï¼Œæ¢å¥è¯è¯´ï¼Œä¸ç®¡æ¨¡å—æ˜¯å¦ä¼šè¢«æ‰§è¡Œï¼Œéƒ½è¦è¢«ç¼–è¯‘å’Œæ‰“åŒ…åˆ° bundle é‡Œã€‚éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§æ‰“åŒ…åçš„ bundle ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œæ‰“åŒ…çš„é€Ÿåº¦è‡ªç„¶ä¹Ÿå°±è¶Šæ¥è¶Šæ…¢ã€‚</p>
<p>Vite åˆ©ç”¨ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒ ESM ç‰¹æ€§ï¼Œçœç•¥äº†å¯¹æ¨¡å—çš„æ‰“åŒ…ã€‚</p>
<p>å¯¹äºéœ€è¦ç¼–è¯‘çš„æ–‡ä»¶ï¼ŒVite é‡‡ç”¨çš„æ˜¯å¦å¤–ä¸€ç§æ¨¡å¼ï¼šå³æ—¶ç¼–è¯‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å…·ä½“å»è¯·æ±‚æŸä¸ªæ–‡ä»¶æ—¶æ‰ä¼šç¼–è¯‘è¿™ä¸ªæ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œè¿™ç§ã€Œå³æ—¶ç¼–è¯‘ã€çš„å¥½å¤„ä¸»è¦ä½“ç°åœ¨ï¼šæŒ‰éœ€ç¼–è¯‘ã€‚</p>
<h2 id="å››ã€æ ¸å¿ƒæ€è·¯"><a href="#å››ã€æ ¸å¿ƒæ€è·¯" class="headerlink" title="å››ã€æ ¸å¿ƒæ€è·¯"></a>å››ã€æ ¸å¿ƒæ€è·¯</h2><h3 id="4-1-åˆå§‹å¯åŠ¨é™æ€æœåŠ¡"><a href="#4-1-åˆå§‹å¯åŠ¨é™æ€æœåŠ¡" class="headerlink" title="4.1 åˆå§‹å¯åŠ¨é™æ€æœåŠ¡"></a>4.1 åˆå§‹å¯åŠ¨é™æ€æœåŠ¡</h3><p>åˆå§‹æ‰§è¡Œå‘½ä»¤  npm run dev â€“&gt; å®é™…å°±æ˜¯å¯åŠ¨äº† /src/node/server/index.ts å¦‚ä¸Šæ–‡æåˆ°å¯åŠ¨äº†ä¸€ä¸ª koa server, è¯¥æ–‡ä»¶è¿˜ä½¿ç”¨äº† chokidar åº“åˆ›å»ºä¸€ä¸ª watcherï¼Œæ¥ç›‘å¬æ–‡ä»¶å˜åŠ¨ï¼š</p>
<pre><code>export function createServer(config: ServerConfig): Server &#123;
  // å¯åŠ¨é™æ€ serverï¼š
  const app = new Koa&lt;State, Context&gt;()
  const server = resolveServer(config, app.callback())
  
  ......
  
  const listen = server.listen.bind(server)
  server.listen = (async (port: number, ...args: any[]) =&gt; &#123;
    ...
  &#125;) as any
  
  
  // å…¶ä¸­å…³é”® 1ï¼šä½¿ç”¨ chokidar å¯¹æ–‡ä»¶è¿›è¡Œé€’å½’ç›‘å¬ï¼šç›‘å¬åˆ°æ–‡ä»¶å˜åŠ¨å¯å¯¹ä¸åŒæ¨¡å—è¿›è¡Œç›¸åº”å¤„ç†
  const watcher = chokidar.watch(root, &#123;
    ignored: [&#39;**/node_modules/**&#39;, &#39;**/.git/**&#39;],
    ...
  &#125;) as HMRWatcher
  
  // å…¶ä¸­å…³é”® 2ï¼šæ‰§è¡Œå„ç±»æ’ä»¶
  const resolvedPlugins = [
    // rewrite and source map plugins take highest priority and should be run
    // after all other middlewares have finished
    sourceMapPlugin,
    moduleRewritePlugin,
    htmlRewritePlugin, // å¤„ç† html æ–‡ä»¶
    // user plugins
    ...toArray(configureServer),
    envPlugin,
    moduleResolvePlugin,
    proxyPlugin,
    clientPlugin, // è¾“å‡ºå®¢æˆ·ç«¯æ‰§è¡Œä»£ç 
    hmrPlugin, // å¤„ç†çƒ­æ¨¡å—æ›´æ–°
    ...(transforms.length || Object.keys(vueCustomBlockTransforms).length
      ? [
          createServerTransformPlugin(
            transforms,
            vueCustomBlockTransforms,
            resolver
          )
        ]
      : []),
    vuePlugin, // å¤„ç†å•æ–‡ä»¶ç»„ä»¶
    cssPlugin, // å¤„ç†æ ·å¼æ–‡ä»¶
    enableEsbuild ? esbuildPlugin : null,
    jsonPlugin,
    assetPathPlugin,
    webWorkerPlugin,
    wasmPlugin,
    serveStaticPlugin
  ]
  resolvedPlugins.forEach((m) =&gt; m &amp;&amp; m(context))
&#125;
</code></pre>
<h3 id="4-2-ç›‘å¬æ¶ˆæ¯ï¼Œæ‹¦æˆªéƒ¨åˆ†è¯·æ±‚"><a href="#4-2-ç›‘å¬æ¶ˆæ¯ï¼Œæ‹¦æˆªéƒ¨åˆ†è¯·æ±‚" class="headerlink" title="4.2 ç›‘å¬æ¶ˆæ¯ï¼Œæ‹¦æˆªéƒ¨åˆ†è¯·æ±‚"></a>4.2 ç›‘å¬æ¶ˆæ¯ï¼Œæ‹¦æˆªéƒ¨åˆ†è¯·æ±‚</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆå§‹ç¬¬ä¸€ä¸ªè¯·æ±‚å¦‚ä¸‹ï¼š<img src="/jiayueshe/jiayueshe.github/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡">é‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å“ªé‡Œæ¥çš„ï¼Ÿè¿™å°±æ˜¯ç»è¿‡ clientPlugin ã€/src/node/server/serverPluginClient.tsã€‘å¤„ç†è¾“å‡ºçš„ï¼š</p>
<pre><code>export const clientPublicPath = `/vite/client` // å½“å‰çš„æ–‡ä»¶åç§°
const legacyPublicPath = &#39;/vite/hmr&#39; // å†å²ç‰ˆæœ¬çš„åç§°
...

export const clientPlugin: ServerPlugin = (&#123; app, config &#125;) =&gt; &#123;
 // clientCode æ›¿æ¢é…ç½®çš„ä¿¡æ¯ï¼Œç”¨äºæœ€å body è¾“å‡ºï¼š
 const clientCode = fs
    .readFileSync(clientFilePath, &#39;utf-8&#39;)
    .replace(`__MODE__`, JSON.stringify(config.mode || &#39;development&#39;))
    ...
app.use(async (ctx, next) =&gt; &#123;
   // è¯·æ±‚è·¯å¾„æ˜¯/vite/client,è¿”å›å“åº”ï¼š200ï¼Œå“åº”æ–‡æœ¬æ˜¯å¤„ç†å¥½çš„ clientCode
    if (ctx.path === clientPublicPath) &#123;
      // è®¾ç½® socket é…ç½®ä¿¡æ¯
      let socketPort: number | string = ctx.port
      ...
      if (config.hmr &amp;&amp; typeof config.hmr === &#39;object&#39;) &#123;
        // hmr option æœ‰æœ€é«˜ä¼˜å…ˆçº§
        ...
      &#125;
      ctx.type = &#39;js&#39;
      ctx.status = 200
      // è¿”å›æ•´åˆå¥½çš„ body
      ctx.body = clientCode.replace(`__HMR_PORT__`, JSON.stringify(socketPort))
    &#125; else &#123;
      if (ctx.path === legacyPublicPath) &#123; // å†å²ç‰ˆæœ¬ /vite/hmr
        console.error(&#39;xxxx&#39;)
      &#125;
      return next()
    &#125;
  &#125;) 
&#125;
</code></pre>
<p>è¯·æ±‚/vite/client å®é™…å°±æ˜¯ /src/client/client.ts æ–‡ä»¶ï¼Œå³è¿”å› body = clientCode = client.ts æ–‡ä»¶å†…å®¹ï¼›é‚£ä¹ˆå®ƒåšå•¥äº†å‘¢ï¼Ÿï¼Ÿï¼Ÿä½¿ç”¨ websoket å¤„ç†æ¶ˆæ¯ï¼Œå¿«é€Ÿç¼–è¯‘ï¼Œè¾¾åˆ°å®æ—¶çƒ­æ›´æ–°ï¼š</p>
<pre><code>const socketProtocol =
  __HMR_PROTOCOL__ || (location.protocol === &#39;https:&#39; ? &#39;wss&#39; : &#39;ws&#39;)
const socketHost = `$&#123;__HMR_HOSTNAME__ || location.hostname&#125;:$&#123;__HMR_PORT__&#125;`
// å¯åŠ¨ websocket é€šä¿¡ï¼Œå¯å®æ—¶å¤„ç†æ¶ˆæ¯ï¼Œå®ç° HMR
const socket = new WebSocket(`$&#123;socketProtocol&#125;://$&#123;socketHost&#125;`, &#39;vite-hmr&#39;)

...
</code></pre>
<p>ç›‘å¬æ¶ˆæ¯ï¼š</p>
<pre><code>socket.addEventListener(&#39;message&#39;, async (&#123; data &#125;) =&gt; &#123;
  const payload = JSON.parse(data) as HMRPayload | MultiUpdatePayload
  handleMessage(payload)
&#125;)
</code></pre>
<p>å¤„ç†æ¶ˆæ¯ï¼š</p>
<pre><code>async function handleMessage(payload) &#123;
    const &#123; path, changeSrcPath, timestamp &#125; = payload;
    switch (payload.type) &#123;
        case &#39;connected&#39;: // socket è¿æ¥æˆåŠŸ
            console.log(`[vite] connected.`);
            break;
        case &#39;vue-reload&#39;: // ç»„ä»¶é‡æ–°åŠ è½½
            queueUpdate(import(`$&#123;path&#125;?t=$&#123;timestamp&#125;`)
                .catch((err) =&gt; warnFailedFetch(err, path))
                .then((m) =&gt; () =&gt; &#123;
                __VUE_HMR_RUNTIME__.reload(path, m.default);
                console.log(`[vite] $&#123;path&#125; reloaded.`);
            &#125;));
            break;
        case &#39;vue-rerender&#39;: // ç»„ä»¶é‡æ–°æ¸²æŸ“
            const templatePath = `$&#123;path&#125;?type=template`;
            import(`$&#123;templatePath&#125;&amp;t=$&#123;timestamp&#125;`).then((m) =&gt; &#123;
                __VUE_HMR_RUNTIME__.rerender(path, m.render);
                console.log(`[vite] $&#123;path&#125; template updated.`);
            &#125;);
            break;
        case &#39;style-update&#39;: // æ ·å¼æ›´æ–°
            // check if this is referenced in html via &lt;link&gt;
            const el = document.querySelector(`link[href*=&#39;$&#123;path&#125;&#39;]`);
            if (el) &#123;
                el.setAttribute(&#39;href&#39;, `$&#123;path&#125;$&#123;path.includes(&#39;?&#39;) ? &#39;&amp;&#39; : &#39;?&#39;&#125;t=$&#123;timestamp&#125;`);
                break;
            &#125;
            // imported CSS
            const importQuery = path.includes(&#39;?&#39;) ? &#39;&amp;import&#39; : &#39;?import&#39;;
            await import(`$&#123;path&#125;$&#123;importQuery&#125;&amp;t=$&#123;timestamp&#125;`);
            console.log(`[vite] $&#123;path&#125; updated.`);
            break;
        case &#39;style-remove&#39;: // æ ·å¼ç§»é™¤
            removeStyle(payload.id);
            break;
        case &#39;js-update&#39;: // js æ›´æ–°
            queueUpdate(updateModule(path, changeSrcPath, timestamp));
            break;
        case &#39;custom&#39;: // è‡ªå®šä¹‰æ›´æ–°
            const cbs = customUpdateMap.get(payload.id);
            if (cbs) &#123;
                cbs.forEach((cb) =&gt; cb(payload.customData));
            &#125;
            break;
        case &#39;full-reload&#39;: // ç½‘é¡µé‡åˆ·æ–°
            if (path.endsWith(&#39;.html&#39;)) &#123;
                ...
            &#125; else &#123;
                location.reload();
            &#125;
    &#125;
&#125;
</code></pre>
<p>å’¦ï¼Ÿé‚£è®¾ç«‹äº† message ç›‘å¬ï¼Œé‚£ message åˆæ˜¯è°å‘å‡ºæ¥çš„å‘¢ï¼Ÿ</p>
<h3 id="4-3-ä¸åŒæ’ä»¶ï¼Œç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè¿”å›æ¶ˆæ¯"><a href="#4-3-ä¸åŒæ’ä»¶ï¼Œç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè¿”å›æ¶ˆæ¯" class="headerlink" title="4.3 ä¸åŒæ’ä»¶ï¼Œç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè¿”å›æ¶ˆæ¯"></a>4.3 ä¸åŒæ’ä»¶ï¼Œç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè¿”å›æ¶ˆæ¯</h3><p>ä¾‹å¦‚ï¼šcssPlugin ã€/src/node/server/serverPluginCss.tsã€‘</p>
<pre><code>// å¤„ç† css æ–‡ä»¶ï¼Œç›‘å¬ css æ–‡ä»¶å˜åŠ¨
export const cssPlugin: ServerPlugin = (&#123; root, app, watcher, resolver &#125;) =&gt; &#123;
  // è¾“å‡º css è¯·æ±‚çš„å“åº”æ¨¡æ¿
  export function codegenCss(
    id: string,
    css: string,
    modules?: Record&lt;string, string&gt;
  ): string &#123;
    let code =
      `import &#123; updateStyle &#125; from &quot;$&#123;clientPublicPath&#125;&quot;\n` +
      `const css = $&#123;JSON.stringify(css)&#125;\n` +
      `updateStyle($&#123;JSON.stringify(id)&#125;, css)\n`
    if (modules) &#123;
      code += dataToEsm(modules, &#123; namedExports: true &#125;)
    &#125; else &#123;
      code += `export default css`
    &#125;
    return code
  &#125;
  
  app.use(async (ctx, next) =&gt; &#123;
    await next()
    // å¤„ç† .css çš„ imports
    ...
    const id = JSON.stringify(hash_sum(ctx.path))
    if (isImportRequest(ctx)) &#123;
      const &#123; css, modules &#125; = await processCss(root, ctx)
      ctx.type = &#39;js&#39;
      // ç”¨`?import`å»é‡å†™ css æ–‡ä»¶ä¸ºä¸€ä¸ª js æ¨¡å—,æ’å…¥ style æ ‡è®°ï¼Œé“¾æ¥åˆ°å®é™…åŸå§‹ url
      ctx.body = codegenCss(id, css, modules)
    &#125;
  &#125;)
  watcher.on(&#39;change&#39;, (filePath) =&gt; &#123;
    // ç­›å‡º css æ–‡ä»¶ï¼Œæ›´æ–° css è¯·æ±‚æ–‡ä»¶
    if (æ–‡ä»¶æ›´æ–°) &#123;
      watcher.send(&#123; // å‘é€æ¶ˆæ¯
        type: &#39;style-update&#39;,
        path: publicPath,
        changeSrcPath: publicPath,
        timestamp: Date.now()
      &#125;)
    &#125;
  &#125;)
  
&#125;
</code></pre>
<h3 id="4-4-é€»è¾‘å°ç»“"><a href="#4-4-é€»è¾‘å°ç»“" class="headerlink" title="4.4 é€»è¾‘å°ç»“"></a>4.4 é€»è¾‘å°ç»“</h3><ul>
<li>å°†å½“å‰é¡¹ç›®ç›®å½•ä½œä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨çš„æ ¹ç›®å½•</li>
<li>æ‹¦æˆªéƒ¨åˆ†æ–‡ä»¶è¯·æ±‚</li>
<li>å¤„ç†ä»£ç ä¸­ import node_modules ä¸­çš„æ¨¡å— b</li>
<li>å¤„ç† Vue å•æ–‡ä»¶ç»„ä»¶ï¼ˆSFC)çš„ç¼–è¯‘</li>
<li>é€šè¿‡ WebSocket å®ç° HMR</li>
</ul>
<h2 id="äº”ã€Snowpack-VS-Vite"><a href="#äº”ã€Snowpack-VS-Vite" class="headerlink" title="äº”ã€Snowpack VS Vite"></a>äº”ã€Snowpack VS Vite</h2><p><strong>åŒï¼š</strong></p>
<ol>
<li>åº•å±‚åŸç†ï¼šSnowpack v2 å’Œ Vite å‡æä¾›åŸºäºæµè§ˆå™¨åŸç”Ÿ ES æ¨¡å—å¯¼å…¥çš„å¼€å‘æœåŠ¡å™¨ï¼›</li>
<li>å†·å¯åŠ¨å¿«é€Ÿï¼šåœ¨å¼€å‘åé¦ˆé€Ÿåº¦æ–¹é¢ï¼Œä¸¤ä¸ªé¡¹ç›®éƒ½å…·æœ‰ç›¸ä¼¼çš„æ€§èƒ½ç‰¹å¾ï¼›</li>
<li>å¼€ç®±å³ç”¨ï¼šé¿å…å„ç§ Loader å’Œ Plugin çš„é…ç½®ã€‚</li>
</ol>
<p>Vite é»˜è®¤æƒ…å†µä¸‹æ”¯æŒæ›´å¤šçš„é€‰æ‹©åŠ å…¥åŠŸèƒ½-ä¾‹å¦‚ TypeScript transpilationã€CSS importã€CSS Modules å’Œ postcss æ”¯æŒï¼ˆéœ€è¦å•ç‹¬å®‰è£…æ‰€å¯¹åº”çš„ç¼–è¯‘å™¨) éƒ½æ˜¯ç°æˆçš„ï¼Œæ— éœ€é…ç½®ï¼›snowpack ä¹Ÿæ˜¯æ”¯æŒ JSXã€TypeScriptã€Reactã€Preactã€CSS Modules ç­‰æ„å»ºï¼Œéé»˜è®¤ï¼›</p>
<ol>
<li>æ’ä»¶ï¼šæ”¯æŒå¾ˆå¤šè‡ªå®šä¹‰æ’ä»¶ï¼›Vite å…³äºè¿™éƒ¨åˆ†çš„å®˜æ–¹æ–‡æ¡£è¿˜æ²¡æœ‰ã€‚</li>
</ol>
<p><strong>å¼‚ï¼š</strong></p>
<ol>
<li>æ¼”å˜ï¼šSnowpack æœ€åˆä¸æä¾› HMR æ”¯æŒï¼Œä½†åœ¨ v2 æ·»åŠ äº†å®ƒï¼Œä»è€Œä½¿ä¸¤ä¸ªé¡¹ç›®çš„èŒƒå›´æ›´åŠ æ¥è¿‘ã€‚Vite æœ€åˆå°±æ˜¯å‚è€ƒäº† snowpack v1; åŒæ–¹åœ¨åŸºäº ESM çš„ HMR ä¸Šåˆä½œè¿‡ï¼Œå°è¯•å»ºç«‹ç»Ÿä¸€çš„ api ESM-HMR API è§„èŒƒï¼Œ ä½†å› ä¸ºåº•å±‚ä¸åŒè¿˜æ˜¯ä¼šç•¥å¾®ä¸åŒï¼›</li>
<li>ä½¿ç”¨ï¼šVite å½“å‰æš‚æ—¶åªèƒ½ç»™ Vue 3.x.ä½¿ç”¨+react ç­‰éƒ¨åˆ†æ¨¡æ¿, å¯¹ vue æ”¯æŒæ›´æ£’ğŸ‘ï¼›snowpack æ²¡é™åˆ¶ï¼›</li>
<li>ç”Ÿäº§æ‰“åŒ…ï¼šVite ç”¨ rollupï¼Œæ‰“åŒ…ä½“ç§¯æ›´å°ï¼ˆ<strong>rollupInputOptionsï¼šå®šä¹‰ rollup çš„æ’ä»¶åŠŸèƒ½</strong>ï¼‰ï¼›snowpack ç”¨ parcel/webpackï¼›- å†³å®šäº†å¼€å‘è€…ç”Ÿäº§ä¸ªæ€§åŒ–é…ç½®çš„æ–¹æ¡ˆä¸ä¸€æ ·ï¼›</li>
<li>åå‘ï¼šVue æ”¯æŒæ˜¯ Vite ä¸­çš„ä¸€çº§åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼ŒVite æä¾›äº†ä¸€ä¸ªæ›´ç»†ç²’åº¦çš„ HMR ä¸ Vue çš„é›†æˆï¼Œå¹¶ä¸”å¯¹æ„å»ºé…ç½®è¿›è¡Œäº†å¾®è°ƒï¼Œä»¥ç”Ÿæˆæœ€é«˜æ•ˆçš„ bundleï¼›</li>
<li>æ–‡æ¡£å®Œå–„æ€§ï¼š</li>
</ol>
<ul>
<li>Vitejs ä¼˜ç‚¹æ˜¯å°¤é›¨æºªå‡ºå“ï¼Œå¯èƒ½å’Œ Vue3 ç”Ÿæ€æ›´å¥½çš„èåˆã€‚ç¼ºç‚¹æ˜¯æ–‡æ¡£ä¸å®Œå–„ã€‚ç›®å‰ star 13.7kï¼›</li>
<li>Snowpack ä¼˜ç‚¹æ˜¯æ›´åŠ æˆç†Ÿï¼Œæœ‰æˆç†Ÿçš„ v1 å’Œå·²ç»å‘å¸ƒæ­£å¼ç‰ˆçš„ v2, æ”¯æŒ reactï¼Œ Vueï¼Œ preactï¼Œ svelte ç­‰å„ç±»åº”ç”¨ï¼Œæ–‡æ¡£ä¹Ÿæ›´åŠ å®Œå–„ã€‚ç›®å‰ star 14.4kã€‚</li>
</ul>
<p><strong>soã€‚ã€‚ã€‚å¦‚ä½•é€‰æ‹©ï¼Ÿï¼š</strong>=&gt; é€‰ Vite:</p>
<ol>
<li>å–œæ¬¢ç”¨ Vueï¼Œé‚£ä¹ˆ Vite æä¾›æ›´å¥½æ”¯æŒï¼›</li>
<li>è¯‰æ±‚æ˜¯æ‰“åŒ… bundle ä½“ç§¯å° ï¼Œé‚£ä¹ˆ Vue ä½¿ç”¨ rollupğŸ‘Œã€‚</li>
</ol>
<p>=&gt; é€‰ Snowpackï¼š</p>
<ol>
<li>ä¸å–œæ¬¢ç”¨ Vue,ä¸ç”¨ vue-cli,å–œæ¬¢ react ç­‰ï¼›</li>
<li>å¤§çš„ team æƒ³è¦ä½¿ç”¨å„ç±»æ’ä»¶ pluginï¼Œæƒ³è¦æ¸…æ™°çš„æ–‡æ¡£ğŸ“šç­‰ï¼›</li>
<li>å¯¹ Webpack æ¯”è¾ƒç”¨çš„æƒ¯ï¼Œæƒ³è¦å¼€å‘æ¨¡å¼ä¸è¦ bundle æ‰“åŒ…ï¼Œæ›´å¿«é€ŸğŸ‘€ã€‚</li>
</ol>
<p>æ¥æºï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/nI9o0NyoAI7jjreoflk79A">https://mp.weixin.qq.com/s/nI9o0NyoAI7jjreoflk79A</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">è’‹å²³ç”Ÿ</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://github.com/jiayueshe/jiayueshe.github.io/2021/03/03/ziliao/javascript/vite-ti-yan/">https://github.com/jiayueshe/jiayueshe.github.io/2021/03/03/ziliao/javascript/vite-ti-yan/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">è’‹å²³ç”Ÿ</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/vite/">
                                    <span class="chip bg-color">vite</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2021/03/03/ziliao/javascript/qian-duan-xing-neng-you-hua-jin-jie/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/23.jpg" class="responsive-img" alt="å‰ç«¯æ€§èƒ½ä¼˜åŒ–ã€è¿›é˜¶ç¯‡ã€‘">
                        
                        <span class="card-title">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ã€è¿›é˜¶ç¯‡ã€‘</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            å‰ç«¯æ€§èƒ½ä¼˜åŒ–ã€è¿›é˜¶ç¯‡ã€‘
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-03-03
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="post-category">
                                    æ€§èƒ½ä¼˜åŒ–
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%89%8D%E7%AB%AF/">
                        <span class="chip bg-color">å‰ç«¯</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/03/03/ziliao/javascript/wo-yong-liao-liang-ge-yue-li-jie-let/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            å‰ç«¯æ‹“å±•ï¼šå¦‚ä½•å¼€å‘ä¸€ä¸ª Chrome æ’ä»¶ï¼Ÿ
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/" class="post-category">
                                    æµè§ˆå™¨
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%8F%92%E4%BB%B6/">
                        <span class="chip bg-color">æ’ä»¶</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">JiangYuesheng</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">115.3k</span>&nbsp;å­—
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/jiayueshe/jiayueshe.github.io" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>
    

        
            <a href="mailto:732767079@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
                <i class="fas fa-envelope-open"></i>
            </a>
            

                <!-- 

 -->

                
                    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=732767079" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 732767079" data-position="top" data-delay="50">
                        <i class="fab fa-qq"></i>
                    </a>
                    
                        <!-- 


 -->

                        
                            <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
                                <i class="fas fa-rss"></i>
                            </a>
                            </div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon.min.js" async="async"></script>
    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
